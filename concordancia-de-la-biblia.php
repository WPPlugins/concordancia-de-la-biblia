<?php/*Plugin Name: Concordancia de la BibliaPlugin URI: https://wordpress.org/plugins/concordancia-de-la-biblia/Description: Buscar cualquier palabra en varias versiones de la Biblia, con la mas potente concordancia del mundo desde BibliaTodo.comVersion: 1.0Author: Bibliatodo.comAuthor URI: https://www.bibliatodo.comLicense: GPL2  Copyright 2016  BibliaTodo.com  (email : bibliatodo1@gmail.com)    This program is free software; you can redistribute it and/or modify    it under the terms of the GNU General Public License, version 2, as     published by the Free Software Foundation.    This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.    You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA*/function cdlb_agregar_css_concordancia_de_la_biblia() {	wp_register_style( 'prefix-style', plugins_url('cdlb-concordancia-de-la-biblia.css', __FILE__) );	wp_enqueue_style( 'prefix-style' );}add_action( 'wp_enqueue_scripts', 'cdlb_agregar_css_concordancia_de_la_biblia' );function cdlb_concordancia_funcion_de_la_biblia($showlink, $language='es') {	$languageAdd = '';	$languageUrl = '';	if($language == '')	{		$languageAdd = '';	}	else if($language == 'en')	{		$languageAdd = '_en';		$languageUrl = ''; /* aqui va el parametro para el idioma ingles */	}	else	{		$language = 'es';	}	$position = rand(0, 200);	$cdlb_concordancia_biblia = get_option('cdlb_concordancia_biblia_' . $position . $languageAdd);	$cdlb_concordancia_biblia_lastAttempt = get_option('cdlb_concordancia_biblia_LastAttempt' . $languageAdd);		if($cdlb_concordancia_biblia == "" && $cdlb_concordancia_biblia_lastAttempt < (date('U') - 3600))	{		$url = 'https://www.bibliatodo.com/recursos/plugin_concordancia?=' . $language . '&position=' . $position . '&url=' . $_SERVER['HTTP_HOST'] . '&type=random2_1';		$result = wp_remote_get($url);		if(!is_wp_error($result)) 		{			$cdlb_concordancia_biblia = str_replace(',', '&#44;', $result['body']);			update_option('cdlb_concordancia_biblia_' . $position . $languageAdd, $cdlb_concordancia_biblia);		}		else		{			update_option('cdlb_concordancia_biblia_LastAttempt' . $languageAdd, date('U'));		}	}	if($cdlb_concordancia_biblia == "")	{		if($language == "kjv")		{			$bibleVerseOfTheDay_bibleVerse = '<div class="Porque de tal manera amÃ³ Dios al mundo, que ha dado a su Hijo unigÃ©nito, para que todo aquel que en Ã©l cree, no se pierda, mas tenga vida eterna.</div><div class="concordancia.linkToWebsite"><a href="https://www.bibliatodo.com/biblia/Reina-valera-1960/juan-3-16" target="_blank">Juan 3:16</a></div>';		}	}			if($showlink == 'true' || $showlink == '1')	{		$html = $cdlb_concordancia_biblia . '<div class="cdlb_agregarverso"><a href="https://www.bibliatodo.com/recursos' . $languageUrl . '" target="_blank">Agrega esta Concordancia a tu Sitio Web</div>';	}	else	{		$html = $cdlb_concordancia_biblia;	}		return $html;}add_shortcode('cdlb_concordancia_biblia', 'cdlb_concordancia_funcion_de_la_biblia'); add_shortcode('cdlb_concordancia_biblia_kjv', 'cdlb_concordancia_biblia_kjv '); function cdlb_concordancia_biblia_kjv() {	return cdlb_concordancia_biblia('0', 'kjv');}class cdlb_concordancia_de_la_biblia_Widget extends WP_Widget{  function form($instance)  {    $instance = wp_parse_args( (array) $instance, array( 'title' => 'Bible verse of the day', 'showlink' => '1', 'language' => '' ) );    $title = $instance['title'];	$showlink = $instance['showlink'];	$language = $instance['language'];	?><?php  }   function update($new_instance, $old_instance)  {    $instance = $old_instance;    $instance['title'] = $new_instance['title'];	if($new_instance['showlink'] == '1')	{		$instance['showlink'] = '1';	}	else	{		$instance['showlink'] = '0';	}		if($new_instance['language'] == '')	{		$instance['language'] = 'es';	}	else	{		$instance['language'] = $new_instance['language'];	}    return $instance;  }   function widget($args, $instance)  {    extract($args, EXTR_SKIP);     echo $before_widget;    $title = empty($instance['title']) ? ' ' : apply_filters('widget_title', $instance['title']);     if (!empty($title))      echo $before_title . $title . $after_title;;  	$showlink = $instance['showlink'];	if($showlink == '')	{		$showlink = '1';	}		$language = $instance['language'];	if($language == '')	{		$language = 'es';	}	    echo ddlb_bible_verse_of_the_day($showlink, $language);     echo $after_widget;  } }class cdlb_concordancia_bibliaWidget extends WP_Widget{  function __construct()   {	parent::__construct('cdlb_concordancia_bibliaWidget', __('Concordancia de la Biblia', 'cdlb_concordancia_biblia' ), array ('description' => __( 'Utilice el cuadro de bÃºsqueda para insertar cualquier palabra, puede buscar todos las versiones de la biblia disponibles, o elegir una individual. Por Bibliatodo.com', 'cdlb_concordancia_biblia')));  }   function form($instance)  {    $instance = wp_parse_args( (array) $instance, array( 'title' => 'Concordancia de la Biblia', 'showlink' => '1', 'language' => 'es' ) );    $title = $instance['title'];	$showlink = $instance['showlink'];	$language = $instance['language'];	?>  <p><label for="<?php echo $this->get_field_id('title'); ?>">Title: <input class="widefat" id="<?php echo $this->get_field_id('title'); ?>" name="<?php echo $this->get_field_name('title'); ?>" type="text" value="<?php echo esc_attr($title); ?>" /></label></p>  <p><select id="<?php echo $this->get_field_id('language'); ?>" name="<?php echo $this->get_field_name('language'); ?>">	<option value="en" <?php _e($language == '' || $language == 'es' ? 'selected' : ''); ?>>Español</option>	<!--  <option value="en" <?php _e($language == 'en' ? 'selected' : ''); ?>>Ingles</option>  -->  </select></p>  <p><input id="<?php echo $this->get_field_id('showlink'); ?>" name="<?php echo $this->get_field_name('showlink'); ?>" type="checkbox" value="1" <?php checked( '1', $showlink ); ?>/><label for="<?php echo $this->get_field_id('showlink'); ?>"><?php _e('&nbsp;Show link to BibliaTodo.com (thank you!)'); ?></label></p><?php  }   function update($new_instance, $old_instance)  {    $instance = $old_instance;    $instance['title'] = $new_instance['title'];	if($new_instance['showlink'] == '1')	{		$instance['showlink'] = '1';	}	else	{		$instance['showlink'] = '0';	}	if($new_instance['language'] == '')	{		$instance['language'] = 'en';	}	else	{		$instance['language'] = $new_instance['language'];	}    return $instance;  }   function widget($args, $instance)  {    extract($args, EXTR_SKIP);     echo $before_widget;    $title = empty($instance['title']) ? ' ' : apply_filters('widget_title', $instance['title']);     if (!empty($title))      echo $before_title . $title . $after_title;;  	$showlink = $instance['showlink'];	if($showlink == '')	{		$showlink = '1';	}		$language = $instance['language'];	if($language == '')	{		$language = 'en';	}	    echo cdlb_concordancia_funcion_de_la_biblia($showlink, $language);     echo $after_widget;  }}add_action( 'widgets_init', create_function('', 'return register_widget("cdlb_concordancia_bibliaWidget");') );?>